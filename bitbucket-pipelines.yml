pipelines:
    branches:
      master:
        - step:
            name: Sync GitHub Mirror
            image: alpine/git:latest
            clone:
                enabled: false
            script:
                - git clone git@bitbucket.org:linn_systems/linn_public_api_specs.git --branch master
                - cd linn_public_api_specs
                - ls -l
                - rm -rf bitbucket-pipelines.yml
                - ls -l
                - git add --all
                - git -c user.name='LinnSystems' -c user.email=team-devops@linnworks.com commit -m "API docs updated"
                - git push --force git@github.com:LinnSystems/PublicApiSpecs.git master:main
        - step:
            name: Readme API sync
            image: node:20.10.0
            clone:
                enabled: false
            script:
                - git clone git@bitbucket.org:linn_systems/linn_public_api_specs.git --branch master
                - cd linn_public_api_specs
                - rm -rf bitbucket-pipelines.yml
                - npx rdme@v10 openapi upload '1.0/auth.json' --key=$key --slug=authenticate-api.json
                - npx rdme@v10 openapi upload '1.0/dashboards.json' --key=$key --slug=dashboards-api.json
                - npx rdme@v10 openapi upload '1.0/email.json' --key=$key --slug=email-api.json
                - npx rdme@v10 openapi upload '1.0/genericlistings.json' --key=$key --slug=generic-listings-api.json
                - npx rdme@v10 openapi upload '1.0/importexport.json' --key=$key --slug=import-and-export-api.json
                - npx rdme@v10 openapi upload '1.0/inventory.json' --key=$key --slug=inventory-api.json
                - npx rdme@v10 openapi upload '1.0/listings.json' --key=$key --slug=listings-api.json
                - npx rdme@v10 openapi upload '1.0/locations.json' --key=$key --slug=locations-api.json
                - npx rdme@v10 openapi upload '1.0/macro.json' --key=$key --slug=macros-api.json
                - npx rdme@v10 openapi upload '1.0/openorders.json' --key=$key --slug=open-orders-api.json
                - npx rdme@v10 openapi upload '1.0/orders.json' --key=$key --slug=orders-api.json
                - npx rdme@v10 openapi upload '1.0/picking.json' --key=$key --slug=picking-api.json
                - npx rdme@v10 openapi upload '1.0/postsale.json' --key=$key --slug=post-sale-cancellations-api.json
                - npx rdme@v10 openapi upload '1.0/postalservices.json' --key=$key --slug=postal-services-api.json
                - npx rdme@v10 openapi upload '1.0/printservice.json' --key=$key --slug=print-service-api.json
                - npx rdme@v10 openapi upload '1.0/printzone.json' --key=$key --slug=print-zone-api.json
                - npx rdme@v10 openapi upload '1.0/processedorders.json' --key=$key --slug=processed-orders-api.json
                - npx rdme@v10 openapi upload '1.0/purchaseorder.json' --key=$key --slug=purchase-orders-api.json
                - npx rdme@v10 openapi upload '1.0/returnsrefunds.json' --key=$key --slug=returns-and-refunds-api.json
                - npx rdme@v10 openapi upload '1.0/rulesengine.json' --key=$key --slug=rules-engine-api.json
                - npx rdme@v10 openapi upload '1.0/settings.json' --key=$key  --slug=settings-api.json
                - npx rdme@v10 openapi upload '1.0/shippingservice.json' --key=$key --slug=shipping-service-api.json
                - npx rdme@v10 openapi upload '1.0/stock.json' --key=$key --slug=stock-api.json
                - npx rdme@v10 openapi upload '1.0/warehousetransfer.json' --key=$key --slug=warehouse-transfer-legacy-api.json
                - npx rdme@v10 openapi upload '1.0/warehousetransfer-new.json' --key=$key --slug=warehouse-transfer.json
                - npx rdme@v10 openapi upload '1.0/wms.json' --key=$key --slug=wms-api.json
                - npx rdme@v10 openapi upload '2.0/warehousetransfer-v2.json' --key=$key --slug=warehouse-transfer.json
                - npx rdme@v10 openapi upload '2.0/orders-v2.json' --key=$key --slug=orders.json
                - npx rdme@v10 openapi upload '2.0/picking-v2.json' --key=$key --slug=picking.json
